@model ABC_Retail.ViewModels.SignUpViewModel

@{
	ViewData["Title"] = "Welcome";
}

<head>
	<link rel="stylesheet" href="~/css/base.css" asp-append-version="true" />
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<style>
		.auth-page-container {
			display: flex;
			justify-content: center;
			align-items: center;
		}

		.form {
			--font-color: #333333;
			--font-color-sub: #666666;
			--bg-color: #fff;
			--main-color: #323232;
			--highlight-color: #eebefa;
			background-color: #fff;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			gap: 10px;
			border-radius: 10px;
			padding: 20px 50px;
			box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
			max-width: 600px;
			width: 100%;
		}

		.title {
			color: var(--font-color);
			font-weight: 900;
			font-size: 26px;
			text-align: center;
		}

			.title span {
				color: var(--font-color-sub);
				font-weight: 600;
				font-size: 20px;
			}

		.form-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 20px;
			width: 100%;
		}

		.inputbox {
			width: 100%;
			height: 45px;
			border-radius: 10px;
			border: 2px solid var(--main-color);
			background-color: var(--bg-color);
			box-shadow: 4px 4px var(--main-color);
			font-size: 17px;
			font-weight: 600;
			color: var(--font-color);
			padding: 10px;
			outline: none;
			transition: box-shadow 0.2s, transform 0.2s;
		}

			.inputbox::placeholder {
				color: var(--font-color-sub);
				opacity: 0.8;
			}

			.inputbox:focus {
				transform: translateY(4px);
				box-shadow: 1px 2px 0px 0px var(--highlight-color);
			}

		.label {
			color: var(--font-color);
			font-weight: 600;
			font-size: 17px;
			width: 100%;
			text-align: left;
		}

		.button-confirm {
			margin-top: 20px;
			width: 100%;
			height: 45px;
			border-radius: 10px;
			border: 2px solid var(--main-color);
			background-color: var(--bg-color);
			box-shadow: 4px 4px var(--main-color);
			font-size: 18px;
			font-weight: 600;
			color: var(--font-color);
			cursor: pointer;
			transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
		}

			.button-confirm:hover {
				background-color: #f0f0f0;
			}

			.button-confirm:active {
				box-shadow: 0px 0px var(--highlight-color);
				transform: translateY(2px);
			}

		.switch-link {
			color: #007bff;
			text-decoration: none;
			cursor: pointer;
		}

			.switch-link:hover {
				color: #007bff;
				text-decoration: underline;
			}

		.full-width {
			grid-column: 1 / -1;
		}

		/* Custom Checkbox Styling */
		.custom-checkbox {
			display: flex;
			align-items: center;
			cursor: pointer;
			user-select: none;
		}

			.custom-checkbox input[type="checkbox"] {
				display: none;
			}

			.custom-checkbox .checkmark {
				width: 20px;
				height: 20px;
				background-color: #fff;
				border: 2px solid var(--main-color);
				border-radius: 5px;
				margin-right: 10px;
				position: relative;
				transition: background-color 0.2s, border-color 0.2s;
			}

			.custom-checkbox input[type="checkbox"]:checked + .checkmark {
				background-color: var(--main-color);
				border-color: var(--main-color);
			}

			.custom-checkbox .checkmark::after {
				content: "";
				position: absolute;
				display: none;
				left: 6px;
				top: 2px;
				width: 5px;
				height: 10px;
				border: solid white;
				border-width: 0 2px 2px 0;
				transform: rotate(45deg);
			}

			.custom-checkbox input[type="checkbox"]:checked + .checkmark::after {
				display: block;
			}
	</style>
</head>

<!-- Display validation summary -->
<div asp-validation-summary="ModelOnly" class="text-danger"></div>

<div class="auth-page-container">
	<!-- Signup Form -->
	<form id="SignUpForm" asp-action="SignUp" asp-controller="Home" method="post" class="form">
		<div class="title">Welcome,<br><span>create an account</span></div>

		<div class="form-grid">
			<!-- Name Input -->
			<div>
				<label asp-for="Name" class="label">Name</label>
				<input asp-for="Name" placeholder="Admin" class="inputbox" required>
				<span asp-validation-for="Name" class="text-danger"></span>
			</div>

			<!-- Surname Input -->
			<div>
				<label asp-for="Surname" class="label">Surname</label>
				<input asp-for="Surname" placeholder="Guy" class="inputbox" required>
				<span asp-validation-for="Surname" class="text-danger"></span>
			</div>

			<!-- Phone Number Input (full width) -->
			<div class="full-width">
				<label asp-for="Phone" class="label">Phone Number</label>
				<input asp-for="Phone" placeholder="064 624 3554" class="inputbox" required>
				<span asp-validation-for="Phone" class="text-danger"></span>
			</div>

			<!-- Email Input (full width) -->
			<div class="full-width">
				<label asp-for="Email" class="label">Email</label>
				<input asp-for="Email" placeholder="Admin@gmail.com" class="inputbox" required>
				<span asp-validation-for="Email" class="text-danger"></span>
			</div>

			<!-- Password Input -->
			<div>
				<label asp-for="Password" class="label">Password</label>
				<input asp-for="Password" type="password" placeholder="Admin12345!" class="inputbox" required>
				<span asp-validation-for="Password" class="text-danger"></span>
			</div>

			<!-- Confirm Password Input -->
			<div>
				<label asp-for="ConfirmPassword" class="label">Confirm Password</label>
				<input asp-for="ConfirmPassword" type="password" placeholder="Confirm Password" class="inputbox" required>
				<span asp-validation-for="ConfirmPassword" class="text-danger"></span>
			</div>
		</div>

		<br />

		<button type="submit" class="button-confirm">Sign Up</button>

		<p><a class="switch-link" asp-controller="Home" asp-action="Login">Already have an account? Log In!</a></p>
	</form>
</div>

@section Scripts {
	@await Html.PartialAsync("_ValidationScriptsPartial")

	<script>
		$(document).ready(function () {
			// Form submit
			$('#SignUpForm').on('submit', function(e) {
				e.preventDefault();

				var formData = new FormData(this);

				$.ajax({
					url: '@Url.Action("SignUp", "Home")',
					type: 'POST',
					data: formData,
					contentType: false,
					processData: false,
					success: function(response) {
						if (response.success) {
							Swal.fire({
								title: 'Account Created!',
								text: 'Your Account has been created successfully.',
								icon: 'success'
							}).then((result) => {
								if (result.isConfirmed) {
									window.location.href = '@Url.Action("Login", "Home")';
								}
							});
						} else {
							Swal.fire({
								title: 'Oops!',
								text: response.message || 'Please enter all required info.',
								icon: 'error'
							});

							// Display validation errors
							if (response.errors) {
								$.each(response.errors, function(key, value) {
									$('[name="' + key + '"]').next('.text-danger').text(value[0]);
								});
							}
						}
					},
					error: function() {
						Swal.fire({
							title: 'Error!',
							text: 'Something went wrong, please try again later.',
							icon: 'error'
						});
					}
				});
			});
		});
	</script>
}