@model ABC_Retail.ViewModels.CustomerProfileViewModel
@{
	ViewData["Title"] = "My Profile";
	int customerId = Context.Session.GetInt32("CustomerId") ?? 0;
	bool isAdmin = Context.Session.GetString("IsAdmin") == "true";
}

<head>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
	<style>
		body {
			background-color: #f5f5f5;
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		}

		.container2 {
			background-color: #fff;
			border-radius: 12px;
			padding: 25px;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}

		h2 {
			font-weight: 600;
			color: #333;
		}

		.nav-tabs .nav-link {
			font-weight: 500;
			border-radius: 20px;
			color: #333;
			transition: color 0.3s ease, background-color 0.3s ease;
		}

		.nav-tabs .nav-link.active {
			background-color: #343a40;
			color: #fff;
		}

		.table {
			width: 100%;
			border-collapse: separate;
			border-spacing: 0 10px;
		}

		.table thead th {
			background-color: #343a40;
			color: #fff;
			border: none;
			padding: 12px;
			font-size: 1rem;
		}

		.table tbody td {
			background-color: #f9f9f9;
			padding: 15px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
			border-radius: 8px;
			text-align: center;
		}

		.table tbody tr:hover {
			transform: translateY(-2px);
			box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
		}

		.btn {
			border-radius: 20px;
			transition: background-color 0.3s ease, color 0.3s ease;
		}

		.btn-primary {
			background-color: #28a745;
			color: #fff;
		}

		.btn-primary:hover {
			background-color: #218838;
		}
	</style>
</head>

<h2 class="mt-4 mb-3">My Profile</h2>

<div class="container2 mt-5">
	<ul class="nav nav-tabs" id="profileTab" role="tablist">
		<li class="nav-item">
			<a class="nav-link active" id="profile-info-tab" data-bs-toggle="tab" href="#profile-info" role="tab" aria-controls="profile-info" aria-selected="true">Profile Information</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" id="order-history-tab" data-bs-toggle="tab" href="#order-history" role="tab" aria-controls="order-history" aria-selected="false">Order History</a>
		</li>
		@if (isAdmin)
		{
			<li class="nav-item">
				<a class="nav-link" id="admin-orders-tab" data-bs-toggle="tab" href="#admin-orders" role="tab" aria-controls="admin-orders" aria-selected="false">All Customer Orders</a>
			</li>
		}
	</ul>

	<div class="tab-content" id="profileTabContent">
		<!-- Profile Information Tab -->
		<div class="tab-pane fade show active" id="profile-info" role="tabpanel" aria-labelledby="profile-info-tab">
			<div class="row mt-4">
				<div class="col-md-6">
					<h3>Profile Information</h3>
					<form asp-action="EditProfile" method="post">
						<div class="form-group">
							<label asp-for="@Model.Name" class="form-label">Name</label>
							<input asp-for="@Model.Name" class="form-control rounded-pill" />
						</div>
						<div class="form-group">
							<label asp-for="@Model.Surname" class="form-label">Surname</label>
							<input asp-for="@Model.Surname" class="form-control rounded-pill" />
						</div>
						<div class="form-group">
							<label asp-for="@Model.Phone" class="form-label">Phone</label>
							<input asp-for="@Model.Phone" class="form-control rounded-pill" />
						</div>
						<div class="form-group">
							<label asp-for="@Model.Email" class="form-label">Email</label>
							<input asp-for="@Model.Email" class="form-control rounded-pill" />
						</div>
						<button type="submit" class="btn btn-primary mt-3">Update Profile</button>
					</form>
				</div>
			</div>
		</div>

		<!-- Order History Tab -->
		<div class="tab-pane fade" id="order-history" role="tabpanel" aria-labelledby="order-history-tab">
			<div class="row mt-4">
				<div class="col-md-12">
					<h3>Order History</h3>
					@if (Model.OrderHistory != null && Model.OrderHistory.Any())
					{
						<div class="table-responsive table-container">
							<table class="table table-hover table-striped align-middle">
								<thead>
									<tr>
										<th>Order ID</th>
										<th>Total Quantity</th>
										<th>Total Amount</th>
										<th>Date</th>
										<th>Details</th>
									</tr>
								</thead>
								<tbody>
									@foreach (var order in Model.OrderHistory)
									{
										<tr>
											<td>@order.OrderId</td>
											<td>@order.TotalQuantity</td>
											<td>@order.TotalAmount.ToString("C")</td>
											<td>@order.OrderDate.ToString("d MMM yyyy")</td>
											<td>
												<a asp-action="OrderDetails" asp-route-id="@order.OrderId" class="btn btn-info btn-sm rounded-pill">View Details</a>
											</td>
										</tr>
									}
								</tbody>
							</table>
						</div>
					}
					else
					{
						<p>No past orders available.</p>
					}
				</div>
			</div>
		</div>

		<!-- Admin Orders Tab -->
		@if (isAdmin)
		{
			<div class="tab-pane fade" id="admin-orders" role="tabpanel" aria-labelledby="admin-orders-tab">
				<div class="row mt-4">
					<div class="col-md-12">
						<h3>All Orders</h3>
						@if (Model.OrderHistory != null && Model.OrderHistory.Any())
						{
						<div class="table-responsive table-container">
							<table class="table table-hover table-striped align-middle">
								<thead>
									<tr>
										<th>Order ID</th>
										<th>Customer ID</th>
										<th>Total Quantity</th>
										<th>Total Amount</th>
										<th>Date</th>
										<th>Details</th>
									</tr>
								</thead>
								<tbody>
									@foreach (var order in Model.AllOrders)
									{
										<tr>
											<td>@order.OrderId</td>
											<td>@order.CustomerId</td>
											<td>@order.TotalQuantity</td>
											<td>@order.TotalAmount.ToString("C")</td>
											<td>@order.OrderDate.ToString("d MMM yyyy")</td>
											<td>
												<a asp-action="OrderDetails" asp-route-id="@order.OrderId" class="btn btn-info btn-sm rounded-pill">View Details</a>
											</td>
										</tr>
									}
								</tbody>
							</table>
						</div>
						}
						else
						{
							<p>No orders currently available.</p>
						}
					</div>
				</div>
			</div>
		}
	</div>
</div>